// Hyperflow Brand Colors
$hyperflow-deep-purple: #24135f;
$hyperflow-light-purple: #7A52F7;
$hyperflow-white: #FFFFFF;
$hyperflow-light-gray: #E0E0E0;
$hyperflow-vibrant-blue: #3FA9F5;

@use 'card-theme' as * with (
  $ctp-base: $hyperflow-deep-purple,
  $cover-bg: $hyperflow-deep-purple,
  $ctp-surface0: #e4d8fe,
  $ctp-text: #333333,
  $cover-text: $hyperflow-white,
  $ctp-subtext1: #CCCCCC,
  $ctp-subtext0: #CCCCCC,
  $cover-subtitle: $hyperflow-light-gray,
  $ctp-blue: $hyperflow-vibrant-blue,
  $ctp-sky: $hyperflow-vibrant-blue,
  $ctp-mauve: $hyperflow-vibrant-blue,
  $ctp-pink: $hyperflow-vibrant-blue,
  $ctp-yellow: $hyperflow-vibrant-blue,
  $ctp-green: $hyperflow-vibrant-blue,
  $ctp-peach: $hyperflow-vibrant-blue,
  $cover-accent: $hyperflow-vibrant-blue
);

// =============================================================================
// THEME CONFIGURATION VARIABLES (Overriding Catppuccin defaults)
// =============================================================================

// Main slide background
$ctp-base: $hyperflow-deep-purple;
$cover-bg: $hyperflow-deep-purple;

// Content cards background
$ctp-surface0: $hyperflow-light-purple !default;

// Primary text (titles and body)
$ctp-text: $hyperflow-white !default;
$cover-text: $hyperflow-white !default;

// Secondary/supporting text
$ctp-subtext1: $hyperflow-light-gray !default;
$ctp-subtext0: $hyperflow-light-gray !default;
$cover-subtitle: $hyperflow-light-gray !default;

// Accent links/highlights
$ctp-blue: $hyperflow-vibrant-blue !default;
$ctp-sky: $hyperflow-vibrant-blue !default; // For hover states
$ctp-mauve: $hyperflow-vibrant-blue !default; // Used for titles and borders in card-theme
$ctp-pink: $hyperflow-vibrant-blue !default; // Used for h2 in card-theme
$ctp-yellow: $hyperflow-vibrant-blue !default; // Used for h3 in card-theme
$ctp-green: $hyperflow-vibrant-blue !default; // Used for strong in card-theme
$ctp-peach: $hyperflow-vibrant-blue !default; // Used for em in card-theme
$cover-accent: $hyperflow-vibrant-blue !default;

// Typography - Match preview.html font sizes
$font-family: 'Inter', 'Segoe UI', system-ui, sans-serif !default;
$font-size-base: 24px !default;
$font-size-card-content: 22px !default;
$font-size-left-notes: 16px !default;
$font-size-left-notes-small: 14px !default;
$font-size-sources: 11px !default;
$font-size-sources-small: 10px !default;

$line-height: 1.6 !default;

// Layout - Match preview.html proportions
$left-sidebar-width: 28% !default;
$card-border-radius: 20px !default;
$card-border-width: 3px !default;

// Spacing
$spacing-xs: 8px !default;
$spacing-sm: 12px !default;
$spacing-md: 16px !default;
$spacing-lg: 24px !default;
$spacing-xl: 32px !default;
$spacing-xxl: 40px !default;

// =============================================================================
// BASE STYLES (Marpit-compliant)
// =============================================================================

:root {
  // CSS Custom Properties for runtime customization
  --ctp-base: #{$ctp-base};
  --ctp-mantle: #{$ctp-mantle};
  --ctp-crust: #{$ctp-crust};
  --ctp-surface0: #{$ctp-surface0};
  --ctp-surface1: #{$ctp-surface1};
  --ctp-surface2: #{$ctp-surface2};
  --ctp-overlay0: #{$ctp-overlay0};
  --ctp-overlay1: #{$ctp-overlay1};
  --ctp-overlay2: #{$ctp-overlay2};
  --ctp-subtext0: #{$ctp-subtext0};
  --ctp-subtext1: #{$ctp-subtext1};
  --ctp-text: #{$ctp-text};
  --ctp-lavender: #{$ctp-lavender};
  --ctp-blue: #{$ctp-blue};
  --ctp-sapphire: #{$ctp-sapphire};
  --ctp-sky: #{$ctp-sky};
  --ctp-teal: #{$ctp-teal};
  --ctp-green: #{$ctp-green};
  --ctp-yellow: #{$ctp-yellow};
  --ctp-peach: #{$ctp-peach};
  --ctp-maroon: #{$ctp-maroon};
  --ctp-red: #{$ctp-red};
  --ctp-mauve: #{$ctp-mauve};
  --ctp-pink: #{$ctp-pink};
  --ctp-flamingo: #{$ctp-flamingo};
  --ctp-rosewater: #{$ctp-rosewater};
  
  --cover-bg: #{$cover-bg};
  --cover-text: #{$cover-text};
  --cover-accent: #{$cover-accent};
  --cover-subtitle: #{$cover-subtitle};
}

// Base section styles (Marpit requirement)
section {
  width: 1280px;
  height: 720px;
  background: var(--ctp-base);
  color: var(--ctp-text);
  font-family: $font-family;
  font-size: $font-size-base;
  line-height: $line-height;
  margin: 0;
  padding: 0;
  position: relative;
  overflow: hidden;
}

// =============================================================================
// TITLE SLIDE STYLES
// =============================================================================

section.title {
  background: var(--cover-bg) !important;
  color: var(--cover-text) !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: center !important;
  align-items: center !important;
  text-align: center !important;
  padding: 80px !important;

  h1 {
    color: var(--cover-accent) !important;
    font-size: 3.5em !important;
    font-weight: 700 !important;
    margin-bottom: 30px !important;
    letter-spacing: 1px !important;
  }

  h3 {
    color: var(--cover-subtitle) !important;
    font-size: 1.8em !important;
    font-weight: 400 !important;
    margin-bottom: 40px !important;
  }

  em {
    color: var(--ctp-overlay1) !important;
    font-style: normal !important;
  }
}

// =============================================================================
// CARD SYSTEM - DIRECT SECTION STYLING (Match preview.html)
// =============================================================================

// Card sections - direct styling like preview.html
section.card,
section.card-single,
section.card-start,
section.card-middle,
section.card-end {
  background: var(--ctp-base) !important;
  color: var(--ctp-text) !important;
  padding: 0 !important;
  position: relative !important;
  overflow: hidden !important;
}

// Card backgrounds via ::before pseudo-elements (match preview.html)
section.card::before,
section.card-single::before,
section.card-start::before,
section.card-middle::before,
section.card-end::before {
  content: '';
  position: absolute;
  top: 120px;
  right: 80px;
  bottom: 80px;
  left: calc(#{$left-sidebar-width} + 20px);
  background: var(--ctp-surface0);
  border: $card-border-width solid var(--ctp-mauve);
  border-radius: $card-border-radius;
  box-shadow: 0 12px 40px rgba(17, 17, 27, 0.4);
  z-index: 1;
}

// Card middle and end adjustments
section.card-middle::before,
section.card-end::before {
  top: 40px;
}

// Single card - all rounded corners
section.card-single::before {
  border-radius: $card-border-radius;
}

// Card start - top rounded, bottom open
section.card-start::before {
  border-radius: $card-border-radius $card-border-radius 0 0;
  border-bottom: none;
  bottom: 0;
}

// Card middle - no rounded corners, only left/right borders
section.card-middle::before {
  border-radius: 0;
  border-left: $card-border-width solid var(--ctp-mauve);
  border-right: $card-border-width solid var(--ctp-mauve);
  border-top: none;
  border-bottom: none;
  top: 0;
  bottom: 0;
}

// Card end - bottom rounded, top open
section.card-end::before {
  border-radius: 0 0 $card-border-radius $card-border-radius;
  border-top: none;
  top: 0;
}

// Card content padding (match preview.html)
section.card,
section.card-single,
section.card-start,
section.card-middle,
section.card-end {
  padding: 160px 120px 120px calc(#{$left-sidebar-width} + 60px) !important;
}

section.card-middle,
section.card-end {
  padding: 80px 120px 120px calc(#{$left-sidebar-width} + 60px) !important;
}

// =============================================================================
// LEFT NOTES SIDEBAR (Match preview.html positioning)
// =============================================================================

.left-notes {
  position: absolute;
  top: 120px;
  left: 80px;
  width: calc(#{$left-sidebar-width} - 120px);
  bottom: 40px;
  z-index: 3;
  color: #CCCCCC;
  font-size: 16px;
  line-height: 1.5;
  margin: 0;
  padding: 0;
  overflow-y: auto;
  display: flex;
  flex-direction: column;

  h2, h3 {
    color: #3FA9F5;
    font-size: 18px;
    margin: 16px 0 8px 0;
  }

  ul, ol {
    margin: 8px 0;
    padding-left: 16px;
  }

  li {
    margin-bottom: 4px;
    font-size: 14px;
    color: #CCCCCC;
  }

  strong {
    color: #3FA9F5;
  }

  em {
    color: #3FA9F5;
  }

  p {
    margin-bottom: 8px;
    font-size: 14px;
    color: #CCCCCC;
  }

  .sources {
    margin-top: 32px !important;
    padding-top: 24px !important;
    border-top: 2px solid #45475a !important;
    color: #CCCCCC !important;
    font-size: 11px !important;
    line-height: 1.3 !important;
    background: transparent !important;
    padding: 16px !important;
    border-radius: 8px !important;
    margin-right: 10px !important;
    max-height: none !important; // Remove max-height limitation
    overflow: visible !important; // Ensure content is not clipped

    h1, h2, h3, h4, h5, h6 {
      color: #9399b2 !important;
      font-size: 11px !important;
      font-weight: 600 !important;
      margin: 0 0 4px 0 !important;
    }

    strong {
      color: #aaaaaa !important; // Changed to match reference
      font-weight: 600 !important;
      font-size: 11px !important;
    }

    ul, ol {
      margin: 8px 0 !important;
      padding-left: 16px !important;
      list-style: none !important;
    }

    li {
      margin: 8px 0 !important;
      font-size: 10px !important;
      color: #CCCCCC !important;
      position: relative !important;
      line-height: 1.5 !important;

      &:before {
        content: "â€¢ " !important;
        color: #7f849c !important;
        font-weight: bold !important;
      }
    }

    a {
      color: #3FA9F5 !important;
      text-decoration: none !important;
      border-bottom: 2px solid #3FA9F5 !important;
      display: inline-block !important;
      position: relative !important;
      z-index: 10 !important;
      font-weight: 500 !important;
      padding: 2px 0 !important;
      font-size: 10px !important;

      &:hover {
        color: #3FA9F5 !important;
        border-bottom: 2px solid #3FA9F5 !important;
        background: var(--ctp-surface1) !important;
        padding: 2px 4px !important;
        border-radius: 4px !important;
      }
    }

    p {
      margin: 8px 0 !important;
      font-size: 10px !important;
      color: #CCCCCC !important;
    }
  }

// Adjust left notes for middle/end cards
section.card-middle .left-notes,
section.card-end .left-notes {
  top: 80px;
}

// =============================================================================
// SLIDE TITLE (Match preview.html)
// =============================================================================

.slide-title {
  position: absolute !important;
  top: 40px !important;
  left: 80px !important;
  width: calc(#{$left-sidebar-width} - 40px) !important;
  z-index: 3 !important;
  font-size: 28px !important;
  font-weight: 600 !important;
  color: var(--ctp-mauve) !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
  line-height: 1.3 !important;
}

// Hide slide title for middle/end cards
section.card-middle .slide-title,
section.card-end .slide-title {
  display: none !important;
}

// =============================================================================
// CARD CONTENT TYPOGRAPHY (Match preview.html)
// =============================================================================

section.card,
section.card-single,
section.card-start,
section.card-middle,
section.card-end {
  h1 {
    color: var(--ctp-mauve);
    font-size: 40px;
    font-weight: 700;
    margin: 0 0 $spacing-lg 0;
    position: relative;
    z-index: 2;
  }

  h2 {
    color: var(--ctp-pink);
    font-size: 32px;
    font-weight: 600;
    margin: $spacing-lg 0 $spacing-md 0;
    border-bottom: 2px solid var(--ctp-mauve);
    padding-bottom: $spacing-xs;
    position: relative;
    z-index: 2;
  }

  h3 {
    color: var(--ctp-yellow);
    font-size: 24px;
    font-weight: 500;
    margin: 20px 0 $spacing-sm 0;
    position: relative;
    z-index: 2;
  }

  ul, ol {
    margin: $spacing-md 0;
    padding-left: 20px;
    position: relative;
    z-index: 2;
  }

  li {
    margin-bottom: $spacing-xs;
    font-size: $font-size-card-content;
    color: var(--ctp-text);
    line-height: 1.5;
    position: relative;
    z-index: 2;
  }

  p {
    margin-bottom: $spacing-md;
    font-size: $font-size-card-content;
    color: var(--ctp-text);
    line-height: 1.6;
    position: relative;
    z-index: 2;
  }

  strong {
    color: var(--ctp-green);
    font-weight: 700;
  }

  em {
    color: var(--ctp-peach);
    font-style: italic;
  }

  code {
    background: var(--ctp-mantle);
    color: var(--ctp-yellow);
    padding: 4px 8px;
    border-radius: 6px;
    font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
    font-size: 20px;
    border: 1px solid var(--ctp-surface1);
  }
}

// =============================================================================
// GLOBAL ELEMENT STYLES (FALLBACKS)
// =============================================================================

section {
  h1 {
    color: var(--ctp-mauve);
    font-size: 48px;
    font-weight: 700;
    margin-bottom: 20px;
    text-align: left;
  }

  h2 {
    color: var(--ctp-pink);
    font-size: 32px;
    font-weight: 600;
    margin-bottom: 16px;
    border-bottom: 2px solid var(--ctp-mauve);
    padding-bottom: 8px;
  }

  h3 {
    color: var(--ctp-yellow);
    font-size: 24px;
    font-weight: 500;
    margin-bottom: 12px;
  }

  ul, ol {
    margin: 16px 0;
    padding-left: 20px;
  }

  li {
    margin-bottom: 8px;
    font-size: 22px;
    color: var(--ctp-text);
  }

  strong {
    color: var(--ctp-green);
    font-weight: 700;
  }

  em {
    color: var(--ctp-peach);
    font-style: italic;
  }

  code {
    background: var(--ctp-mantle);
    color: var(--ctp-yellow);
    padding: 4px 8px;
    border-radius: 6px;
    font-family: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
    font-size: 20px;
    border: 1px solid var(--ctp-surface1);
  }

  a {
    color: var(--ctp-blue);
    text-decoration: underline;
    font-weight: 500;
    
    &:hover {
      color: var(--ctp-sky);
      text-decoration: none;
    }
  }
}
